# RIZALTA BOT ‚Äî –¢–µ–∫—É—â–∏–µ –∑–∞–¥–∞—á–∏

## –°—Ç–∞—Ç—É—Å: ‚úÖ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 7 –¥–µ–∫–∞–±—Ä—è 2025

---

## ‚úÖ –ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ (—Å–µ—Å—Å–∏—è 07.12.2025)

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –±–æ—Ç–∞

| –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å |
|--------|--------|
| AI Function Calling (5 —Ñ—É–Ω–∫—Ü–∏–π) | ‚úÖ |
| –ö–∞–ª–µ–Ω–¥–∞—Ä—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è | ‚úÖ |
| –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º | ‚úÖ |
| –ì–æ–ª–æ—Å–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (Whisper) | ‚úÖ |
| –ö–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ" –≤ –ö–ü | ‚úÖ |

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

| –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å |
|--------|--------|
| Swap 1GB | ‚úÖ |
| fail2ban | ‚úÖ |
| –ê–≤—Ç–æ–±—ç–∫–∞–ø –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π (3:00) | ‚úÖ |
| –ê–≤—Ç–æ–±—ç–∫–∞–ø –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π (–í—Å 4:00) | ‚úÖ |
| Systemd —Å–µ—Ä–≤–∏—Å—ã (4 —à—Ç.) | ‚úÖ |
| –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ webhook | ‚úÖ |

### –°–µ—Ä–≤–µ—Ä

| –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å |
|--------|--------|
| –ê–ø–≥—Ä–µ–π–¥ –¥–æ 2 CPU, 4GB RAM, 50GB | ‚úÖ |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ | ‚úÖ |

---

## üìã –ó–∞–¥–∞—á–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é —Å–µ—Å—Å–∏—é

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

1. **–î–∞–Ω–Ω—ã–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è**
   - –ü–æ–ª—É—á–∏—Ç—å –æ—Ç –∑–∞–∫–∞–∑—á–∏–∫–∞: –§–ò–û, Telegram chat_id, Email
   - –û–±–Ω–æ–≤–∏—Ç—å SPECIALISTS –≤ booking_calendar.py
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

2. **–ö–æ–º–∞–Ω–¥–∞ /myid**
   - –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è chat_id
   - –°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã —Å–º–æ–≥—É—Ç —É–∑–Ω–∞—Ç—å —Å–≤–æ–π ID —Å–∞–º–∏

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ)

3. **–£—Å–∏–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ SSH**
   - –°–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç 22 ‚Üí 2222
   - –û—Ç–∫–ª—é—á–∏—Ç—å root-–≤—Ö–æ–¥ –ø–æ –ø–∞—Ä–æ–ª—é (—Ç–æ–ª—å–∫–æ SSH-–∫–ª—é—á)
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

4. **Git push –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π**
   - –ó–∞–ø—É—à–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –∫–æ–¥ –≤ GitHub
   - –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

5. **–£–ª—É—á—à–µ–Ω–∏—è UX**
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ä–∏—ç–ª—Ç–æ—Ä–∞–º–∏
   - –°–±–æ—Ä –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–º–µ—Ç–∫–∏

### AI Function Calling ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

```python
TOOLS = [
    # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ
    {"name": "get_finance_info", ...},
    {"name": "get_unit_info", ...},
    {"name": "calculate_roi", ...},
    {"name": "search_units", ...},
    {"name": "get_documents", ...},
    
    # –ù–æ–≤—ã–µ (07.12.2025)
    {"name": "send_presentation", ...},    # "—Å–∫–∏–Ω—å –ø—Ä–µ–∑—É"
    {"name": "open_fixation", ...},        # "–∑–∞–∫—Ä–µ–ø–∏ –∫–ª–∏–µ–Ω—Ç–∞"
    {"name": "open_shahmatka", ...},       # "—á—Ç–æ —Å–≤–æ–±–æ–¥–Ω–æ?"
    {"name": "send_documents", ...},       # "–¥–∞–π –¥–æ–≥–æ–≤–æ—Ä"
    {"name": "show_media", ...},           # "–ø–æ–∫–∞–∂–∏ –≤–∏–¥–µ–æ"
]
```

### –ö–∞–ª–µ–Ω–¥–∞—Ä—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```python
# handlers/booking_calendar.py
SPECIALISTS = [
    {"id": 1, "name": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç 1", "telegram_id": 512319063, "email": "..."},
    {"id": 2, "name": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç 2", "telegram_id": 512319063, "email": "..."},
    {"id": 3, "name": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç 3", "telegram_id": 512319063, "email": "..."},
]
WORK_DAYS = [0, 1, 2, 3, 4, 5]  # –ü–Ω-–°–±
WORK_HOUR_START = 10
WORK_HOUR_END = 16
SLOT_DURATION = 60  # –º–∏–Ω—É—Ç
```

### –ì–æ–ª–æ—Å–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Äî –ø–æ—Ç–æ–∫

```
üé§ –ì–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        ‚Üì
download_file() ‚Üí /tmp/voice_*.ogg
        ‚Üì
Whisper API ‚Üí —Ç–µ–∫—Å—Ç
        ‚Üì
"üìù –†–∞—Å–ø–æ–∑–Ω–∞–Ω–æ: ..."
        ‚Üì
–û–±—ã—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (Regex / AI)
```

### –ê–≤—Ç–æ–±—ç–∫–∞–ø—ã ‚Äî —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ

```bash
# crontab -l
0 3 * * * /opt/bot/backup.sh          # –ï–∂–µ–¥–Ω–µ–≤–Ω–æ 3:00 UTC
0 4 * * 0 /opt/bot/backup_weekly.sh   # –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ 4:00 UTC
```

---

## üìÅ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (07.12.2025)

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

- `handlers/booking_calendar.py` ‚Äî –∫–∞–ª–µ–Ω–¥–∞—Ä—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- `services/speech.py` ‚Äî Whisper API
- `backup.sh` ‚Äî —Å–∫—Ä–∏–ø—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞
- `backup_weekly.sh` ‚Äî —Å–∫—Ä–∏–ø—Ç –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞
- `update_webhook.sh` ‚Äî –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ webhook

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `app.py` ‚Äî callback'–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è, –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- `services/ai_chat.py` ‚Äî 5 –Ω–æ–≤—ã—Ö AI-—Ñ—É–Ω–∫—Ü–∏–π
- `handlers/ai_chat.py` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- `handlers/kp.py` ‚Äî –∫–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ"
- `handlers/__init__.py` ‚Äî –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã
- `services/telegram.py` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è download_file()

### Systemd —Å–µ—Ä–≤–∏—Å—ã

- `/etc/systemd/system/rizalta-bot.service`
- `/etc/systemd/system/cloudflare-rizalta.service`
- `/etc/systemd/system/oazis-bot.service`
- `/etc/systemd/system/cloudflare-oazis.service`

---

## üöÄ –î–µ–ø–ª–æ–π

```bash
# SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh root@72.56.64.91

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞
systemctl restart rizalta-bot

# –õ–æ–≥–∏
journalctl -u rizalta-bot -f

# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
systemctl status rizalta-bot cloudflare-rizalta --no-pager
```
